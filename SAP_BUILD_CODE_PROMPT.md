# Complete Fiori Application Specification for SAP Build Code

Create a professional SAP Fiori application for viewing and managing technical diagrams stored in SAP Document Management Service (DMS). The application needs to be built from scratch with no existing backend logic, so we need to implement everything including data fetching, authentication, and business logic. The application should connect to SAP DMS using the destination named "sap_process_automation_document_store_diagrams" which is configured in the SAP BTP cockpit with OAuth2 authentication and points to the CMIS API endpoint of our Document Management Service repository. The application must use this destination to fetch diagram files stored as SVG format along with their metadata including the document ID, file name, description which is inherited from the parent folder structure, creation date, modification date, author information, and file size. The DMS repository is organized with folders where each folder represents a category like "Cloud Infrastructure" or "Integration Patterns" and the folder's description field contains the category name which gets inherited by all files within that folder, so when we fetch a diagram file we need to also query its parent folder to get the category information. Each SVG file in DMS follows a specific naming convention where the filename contains three parts separated by underscores: first a three-digit ID number like "002", then the diagram name like "SAP Cloud", and finally a version number like "v15", so for example "002_SAP Cloud_v15.svg". The application needs to parse these filenames to extract the diagram ID, name, and version for display purposes. The main user interface should follow the SAP Fiori master-detail pattern where the left side shows a list of all available diagrams and the right side displays the selected diagram with its full metadata. When the application first loads, it should call the CMIS API through the destination to query all documents in the repository using the cmis:query service with a SELECT statement that retrieves cmis:objectId, cmis:name, cmis:description, cmis:createdBy, cmis:creationDate, cmis:lastModificationDate, and cmis:contentStreamLength for all objects where cmis:objectTypeId equals 'cmis:document' and the file name ends with '.svg'. For each returned document, the application needs to make an additional API call to fetch the parent folder information using the cmis:objectId of the folder to retrieve its cmis:description field which contains the category. The master list on the left should display each diagram as a list item showing the parsed diagram ID and name as the title (for example "002 - SAP Cloud (v15)"), the category from the parent folder description as the first description line, the last modification date formatted as a readable date string as the second description line, and the file size converted from bytes to a human-readable format like "245 KB" shown in the info section. The list should support single selection where clicking on any item highlights it with SAP's blue selection color and triggers loading of that diagram's details in the right panel. Above the list there should be a search field with placeholder text "Search by name, ID, or description..." that performs real-time filtering of the list as the user types, searching across the diagram name, ID, description, and category fields with debouncing so it only searches after the user stops typing for 300 milliseconds. Below the search field there should be a filter bar containing multiple filter controls: a multi-select combo box for filtering by category where the options are dynamically populated from all unique categories found in the loaded diagrams, a date range selector for filtering diagrams modified within a specific date range showing "From" and "To" date pickers, another multi-select combo box for filtering by author populated with all unique author names from the loaded diagrams, and an optional text input field for filtering by specific version numbers. The filter bar should have a "Go" button to apply the selected filters and a "Clear" button to reset all filters back to showing all diagrams. When filters are applied, there should be a toolbar above the list showing active filter tokens (for example "[Category: Cloud] [Modified: Last 7 days]") where each token has a small X button to remove that specific filter. The list should initially load only the first 20 diagrams for performance reasons, and at the bottom of the list there should be a "Load More" button that fetches the next 20 diagrams when clicked, with the list header showing the current count like "Showing 20 of 124 diagrams". The detail panel on the right side should initially show an empty state with a diagram icon and text "Select a diagram to view details" when no diagram is selected. Once a diagram is selected, the detail panel needs to make two API calls: first, it calls the CMIS API to get the full metadata using the cmis:objectId, and second, it calls the content stream URL to download the actual SVG file content. The detail panel header should display the full diagram title combining the ID, name, and version (for example "002 - SAP Cloud (v15)") along with three action buttons: a Download button with a download icon that when clicked downloads the SVG file to the user's computer with its original filename, a Share button with a link icon that copies a direct URL to this specific diagram to the clipboard and shows a toast message "Link copied to clipboard", and an Info button that toggles the visibility of the metadata panel. Below the header there should be a large scrollable container displaying the rendered SVG diagram where the SVG content retrieved from the content stream is directly embedded into the DOM, with the container having a white background, subtle border, and allowing both vertical and horizontal scrolling if the diagram is larger than the viewport. The SVG display area should include zoom controls as floating buttons overlaid on the diagram: a zoom-in button that increases the SVG scale by 25%, a zoom-out button that decreases the scale by 25%, a fit-to-width button that automatically scales the SVG to fit the container width, and a reset button that returns the zoom to 100%. The user should also be able to click and drag to pan large diagrams when they're zoomed in. Below the SVG display area there should be an expandable panel with the header "Details" that shows all the diagram metadata in a clean form layout with labeled fields: Category showing the inherited folder description, Description showing the full diagram description text which may be multiple paragraphs, Diagram ID showing just the numeric ID, Version showing just the version number, Created By showing the author's name, Created Date showing the creation timestamp formatted like "Jan 15, 2024, 10:30 AM", Modified Date showing the last modification timestamp in the same format, File Size showing the size in human-readable format, and Document ID showing the internal CMIS object ID. This metadata panel should be collapsed by default on mobile devices to save space but expanded by default on desktop. The entire application must be fully responsive following SAP Fiori's responsive design principles where on desktop screens wider than 1024 pixels the master and detail panels are shown side-by-side with a 40/60 width split, on tablet screens between 768 and 1024 pixels they're shown side-by-side with a 45/55 split and some filters moved into a popover, and on mobile screens smaller than 768 pixels the master list takes the full screen initially and when a diagram is selected it navigates to a full-screen detail view with a back button to return to the list. The application needs proper loading states where initially when the app loads it shows a busy indicator with text "Loading diagrams..." over the master list area, and when a diagram is selected it shows a busy indicator in the detail panel while fetching the metadata and SVG content. Error states must also be handled where if the initial diagram list fails to load it shows an error message "Failed to load diagrams" with the specific error text and a Retry button that attempts to reload the data, and if an individual diagram fails to load it shows a placeholder in the detail panel with error text and a retry option. If the search or filters result in no matching diagrams, the list should show an empty state with a message "No diagrams found" and suggestion text "Try adjusting your filters or search criteria". The application should include a sorting feature accessible via a view settings dialog that allows sorting the diagram list by Name in ascending or descending order, Modified Date showing newest or oldest first, File Size showing largest or smallest first, or Diagram ID in ascending or descending numeric order. The entire application must follow SAP Fiori 3 design guidelines using the standard SAP blue color #0854A0 as the primary color, white #FFFFFF or light gray #F7F7F7 for backgrounds, dark gray #32363A for text, light gray #D9D9D9 for borders, and SAP blue with 10% opacity for selected items. All interactive elements must have proper ARIA labels for accessibility, full keyboard navigation support, screen reader compatibility, and support for SAP's high contrast themes. The application shell should use the SAP Fiori shell bar with the title "Technical Diagrams Viewer" and a user menu in the top right corner. For optimal performance, the application should implement client-side caching where once a diagram's SVG content is loaded it's stored in memory so subsequent selections of the same diagram don't require re-downloading the content, and this cache should be cleared when the user refreshes the page. The SVG content should only be fetched when a diagram is actually selected rather than pre-loading all SVG files at startup. The destination "sap_process_automation_document_store_diagrams" must be configured in the application's manifest.json file as a data source and all API calls must route through this destination which handles the OAuth2 authentication automatically via the destination service. The CMIS API calls should use the browser/ endpoint for querying documents with GET requests to the repository browser service, and the content should be retrieved using the cmis:objectId to construct the content stream URL in the format /browser/{repositoryId}/root/path/to/file?cmisaction=download. Error handling must be robust where any 401 unauthorized errors are caught and displayed with a message suggesting the user check their authentication, 404 errors show "Diagram not found", 500 errors show "Server error occurred", and network errors show "Unable to connect to server". The application code should be organized following SAP's recommended project structure with separate folders for controllers, views, models, services, and utilities, where the data fetching logic is encapsulated in a service module that exports functions like fetchAllDiagrams(), fetchDiagramMetadata(objectId), fetchDiagramContent(objectId), and fetchFolderMetadata(folderId) which all use the destination for API calls. The filename parsing logic should be in a utility module with a function parseFilename(filename) that returns an object with diagramId, name, and version properties extracted using regex pattern matching on the underscore-delimited filename format. Date formatting should use SAP's date formatter utilities to ensure dates are displayed according to the user's locale settings. The application should include comprehensive error logging where all errors are logged to the browser console with full stack traces to aid in debugging. The initial MVP must include listing all diagrams from DMS, displaying SVG diagrams in the detail panel, showing all metadata fields, search functionality by name and ID, download capability for SVG files, responsive design for desktop and mobile, category filtering, and date range filtering, while nice-to-have features like thumbnail previews, offline support, favorites bookmarking, side-by-side diagram comparison, export to PNG or PDF, and comment annotations can be added in future iterations. The application must be deployable to SAP BTP Cloud Foundry and should include the necessary manifest.yml and xs-app.json configuration files for routing and authentication integration with the SAP Authorization and Trust Management service.
